flowchart TD
    subgraph Step 1: Extract
        STEPS[Agent Steps] --> EXT[LLM Extractor]
        EXT --> OPS[SQL Operations + Results]
    end

    subgraph Step 2: Execute Expected
        EXPSQL[Expected SQL] --> EXEC[Execute]
        EXEC --> EXPRES[Expected Results]
    end

    subgraph Step 3: Judge
        OPS --> JUDGE[LLM Judge]
        EXPSQL --> JUDGE
        EXPRES --> JUDGE
        JUDGE --> SCORE[Score + Reasoning]
    end

    classDef input fill:#dbeafe,stroke:#3b82f6,stroke-width:2px,color:#1e40af
    classDef extract fill:#cffafe,stroke:#06b6d4,stroke-width:2px,color:#0e7490
    classDef execute fill:#fef3c7,stroke:#f59e0b,stroke-width:2px,color:#b45309
    classDef judge fill:#ede9fe,stroke:#8b5cf6,stroke-width:2px,color:#5b21b6
    classDef output fill:#d1fae5,stroke:#10b981,stroke-width:2px,color:#065f46

    class STEPS input
    class EXT,OPS extract
    class EXPSQL,EXEC,EXPRES execute
    class JUDGE judge
    class SCORE output
