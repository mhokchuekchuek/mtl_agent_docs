flowchart LR
    subgraph Input
        PDF[PDF Files]
    end

    subgraph Parse
        Parser[PDF Parser<br/>PyPDF2/Docling]
    end

    subgraph Extract
        LLM[LLM Extractor<br/>gpt-4o-mini]
        Prompt[Langfuse Prompt<br/>ingestor_extract_product]
    end

    subgraph Embed
        Embedder[Embedding Model<br/>text-embedding-3-small]
    end

    subgraph Store
        Qdrant[(Qdrant<br/>Vector DB)]
    end

    PDF --> Parser
    Parser -->|markdown/text| LLM
    Prompt -.->|inject| LLM
    LLM -->|structured JSON| Embedder
    Embedder -->|vectors| Qdrant

    classDef input fill:#dbeafe,stroke:#3b82f6,stroke-width:2px,color:#1e40af
    classDef parse fill:#fef3c7,stroke:#f59e0b,stroke-width:2px,color:#b45309
    classDef extract fill:#ede9fe,stroke:#8b5cf6,stroke-width:2px,color:#5b21b6
    classDef embed fill:#cffafe,stroke:#06b6d4,stroke-width:2px,color:#0e7490
    classDef store fill:#d1fae5,stroke:#10b981,stroke-width:2px,color:#065f46

    class PDF input
    class Parser parse
    class LLM,Prompt extract
    class Embedder embed
    class Qdrant store
