flowchart LR
    1[1. Receive request] --> 2[2. Get service from app.state]
    2 --> 3[3. Call service.chat]
    3 --> 4[4. Return response + intent + chart]

    classDef request fill:#dbeafe,stroke:#3b82f6,stroke-width:2px,color:#1e40af
    classDef service fill:#cffafe,stroke:#06b6d4,stroke-width:2px,color:#0e7490
    classDef apicall fill:#fef3c7,stroke:#f59e0b,stroke-width:2px,color:#b45309
    classDef response fill:#d1fae5,stroke:#10b981,stroke-width:2px,color:#065f46

    class 1 request
    class 2 service
    class 3 apicall
    class 4 response
